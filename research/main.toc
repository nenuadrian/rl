\contentsline {section}{\numberline {1}Research Questions}{2}{section.1}%
\contentsline {section}{\numberline {2}Preliminaries}{2}{section.2}%
\contentsline {subsection}{Maximum Likelihood Estimation and Maximum a Posteriori}{2}{section*.2}%
\contentsline {subsection}{EM Lower Bound -- ELBO}{2}{section*.3}%
\contentsline {subsection}{EM Iterations}{3}{section*.4}%
\contentsline {subsection}{EM Policy Iteration vs Policy Gradients}{3}{section*.5}%
\contentsline {section}{\numberline {3}V-MPO: Maximum a Posteriori Policy Optimization}{3}{section.3}%
\contentsline {paragraph}{Policy Evaluation (Critic Update).}{4}{section*.6}%
\contentsline {paragraph}{Policy Improvement via EM}{4}{section*.7}%
\contentsline {paragraph}{E-Step: Non-Parametric Policy Construction}{4}{section*.8}%
\contentsline {paragraph}{M-Step: Parametric Projection with KL Constraint}{5}{section*.9}%
\contentsline {section}{\numberline {4}PPO: Proximal Policy Optimization}{5}{section.4}%
\contentsline {paragraph}{Full Objective}{6}{section*.11}%
\contentsline {paragraph}{Sequence-Level PPO (LLM Case)}{6}{section*.12}%
\contentsline {section}{\numberline {5}The Case for Dropout}{6}{section.5}%
\contentsline {subsection}{Why PPO Disables Dropout}{7}{section*.13}%
\contentsline {paragraph}{Problem 1: stochastic numerator.}{7}{section*.14}%
\contentsline {paragraph}{Problem 2: inconsistent denominator.}{7}{section*.15}%
\contentsline {paragraph}{Problem 3: KL penalty corruption.}{7}{section*.16}%
\contentsline {subsection}{Why V-MPO / EM-Style Methods Are Dropout-Compatible}{7}{section*.17}%
\contentsline {paragraph}{E-step: weights from advantages, not ratios.}{7}{section*.18}%
\contentsline {paragraph}{M-step: standard cross-entropy.}{7}{section*.19}%
\contentsline {paragraph}{No ratio, no conflict.}{8}{section*.20}%
\contentsline {subsection}{Practical Implications}{8}{section*.21}%
\contentsline {section}{\numberline {6}DPO: Direct Preference Optimization}{8}{section.6}%
\contentsline {paragraph}{Closed-form optimal policy.}{8}{section*.22}%
\contentsline {paragraph}{Reward reparameterisation.}{8}{section*.23}%
\contentsline {paragraph}{Bradley--Terry preference model.}{9}{section*.24}%
\contentsline {paragraph}{The DPO loss.}{9}{section*.25}%
\contentsline {paragraph}{DPO as Preference MLE}{9}{section*.26}%
\contentsline {paragraph}{DPO and the EM Framework}{9}{section*.27}%
\contentsline {paragraph}{The ``collapsed EM'' interpretation.}{9}{section*.28}%
\contentsline {paragraph}{What is lost.}{9}{section*.29}%
\contentsline {paragraph}{Dropout compatibility.}{10}{section*.30}%
\contentsline {section}{\numberline {7}AWR: Advantage-Weighted Regression}{10}{section.7}%
\contentsline {paragraph}{Expected improvement objective.}{10}{section*.31}%
\contentsline {paragraph}{Constrained policy search (primal).}{10}{section*.32}%
\contentsline {paragraph}{Lagrangian and stationarity.}{10}{section*.33}%
\contentsline {paragraph}{Projection to parameterised policy (regression step).}{10}{section*.35}%
\contentsline {paragraph}{Value update.}{11}{section*.37}%
\contentsline {section}{\numberline {8}DAR: Direct Advantage Regression}{11}{section.8}%
\contentsline {paragraph}{RL Fine-tuning}{11}{section*.39}%
\contentsline {paragraph}{Advantage Weighted Regression}{11}{section*.40}%
\contentsline {paragraph}{Dual-Constrained Objective}{11}{section*.41}%
\contentsline {paragraph}{Theorem.}{11}{section*.42}%
\contentsline {paragraph}{Proof.}{12}{section*.43}%
\contentsline {paragraph}{Mapping \textsc {DAR} to V-MPO}{12}{section*.44}%
\contentsline {paragraph}{DAR closed-form target.}{13}{section*.45}%
\contentsline {paragraph}{V-MPO canonical target.}{13}{section*.46}%
\contentsline {paragraph}{Special case 1: identical reference and sampling policies.}{13}{section*.47}%
\contentsline {paragraph}{Special case 2: \(\alpha \rightarrow 0\) (reference KL vanishes).}{13}{section*.48}%
\contentsline {paragraph}{Algebraic equivalence (log-space explanation).}{13}{section*.49}%
\contentsline {paragraph}{Practical consequences and distinctions.}{14}{section*.50}%
\contentsline {paragraph}{Bridge to the EM.}{14}{section*.51}%
\contentsline {paragraph}{Sequence-level weighted loss (common form).}{14}{section*.52}%
\contentsline {section}{\numberline {9}(G)TrXL - Transformers for RL}{14}{section.9}%
\contentsline {subsection}{GTrXL with V-MPO}{14}{section*.53}%
\contentsline {subsubsection}{Identity Map Reordering (TrXL-I)}{14}{section*.54}%
\contentsline {subsubsection}{Gating Layers}{15}{section*.55}%
\contentsline {subsubsection}{Why GTrXL Suits V-MPO}{15}{section*.56}%
\contentsline {subsubsection}{Architecture and Training Configuration}{15}{section*.57}%
\contentsline {section}{\numberline {10}Generalized EM Policy Improvement (GEMPI)}{15}{section.10}%
\contentsline {paragraph}{The GEMPI tuple.}{15}{section*.58}%
\contentsline {subsection}{General Regularized E-Step}{16}{section*.59}%
\contentsline {paragraph}{Theorem (Multi-KL Closed Form).}{16}{section*.60}%
\contentsline {paragraph}{Proof.}{16}{section*.61}%
\contentsline {paragraph}{Log-space form.}{16}{section*.62}%
\contentsline {paragraph}{Multi-temperature dual.}{16}{section*.63}%
\contentsline {subsection}{General M-Step}{17}{section*.64}%
\contentsline {paragraph}{Importance-weighted practical form.}{17}{section*.65}%
\contentsline {paragraph}{1. Partition function bias.}{17}{section*.66}%
\contentsline {paragraph}{2. Effective sample size and weight degeneracy.}{18}{section*.67}%
\contentsline {paragraph}{3. M-step gradient bias under finite ESS.}{18}{section*.68}%
\contentsline {paragraph}{Connection to GEMPI stabilisers.}{18}{section*.69}%
\contentsline {paragraph}{Remark on the population vs.\ sample limit.}{18}{section*.70}%
\contentsline {subsection}{Recovering Existing Methods}{18}{section*.71}%
\contentsline {paragraph}{V-MPO.}{19}{section*.72}%
\contentsline {paragraph}{DAR.}{19}{section*.73}%
\contentsline {paragraph}{AWR.}{19}{section*.74}%
\contentsline {paragraph}{SFT.}{19}{section*.75}%
\contentsline {paragraph}{DPO (collapsed).}{19}{section*.76}%
\contentsline {paragraph}{DAR$\rightarrow $V-MPO as corollary.}{19}{section*.77}%
\contentsline {subsection}{The Role of Divergence Choice}{19}{section*.78}%
\contentsline {subsection}{Stability Properties as Structural Consequences}{20}{section*.79}%
\contentsline {paragraph}{Adaptive temperature.}{20}{section*.80}%
\contentsline {paragraph}{Trust regions in the M-step.}{20}{section*.81}%
\contentsline {paragraph}{Top-$k$ filtering.}{20}{section*.82}%
\contentsline {paragraph}{Dropout compatibility.}{20}{section*.83}%
\contentsline {subsection}{Novel Instantiations}{20}{section*.84}%
\contentsline {paragraph}{Adaptive-Temperature DAR (AT-DAR).}{20}{section*.85}%
\contentsline {paragraph}{DAR with M-step Trust Region (DAR-TR).}{20}{section*.86}%
\contentsline {paragraph}{Top-$k$ DAR.}{21}{section*.87}%
\contentsline {subsection}{Worked Instantiation: LLM V-MPO}{21}{section*.88}%
\contentsline {paragraph}{GEMPI tuple.}{21}{section*.89}%
\contentsline {paragraph}{Sequence-level E-step for transformer rollouts.}{21}{section*.90}%
\contentsline {paragraph}{M-step as weighted teacher-forced transformer training.}{21}{section*.91}%
\contentsline {paragraph}{Transformer-specific practicalities.}{22}{section*.92}%
\contentsline {paragraph}{Dropout in the LLM V-MPO M-step.}{22}{section*.93}%
\contentsline {section}{\numberline {A}Comprehensive Method Comparison}{22}{appendix.A}%
