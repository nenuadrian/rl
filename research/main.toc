\contentsline {section}{\numberline {1}Introduction}{3}{section.1}%
\contentsline {section}{\numberline {2}Research Questions}{3}{section.2}%
\contentsline {section}{\numberline {3}Preliminaries}{3}{section.3}%
\contentsline {subsection}{Maximum Likelihood and Maximum a Posteriori}{3}{section*.2}%
\contentsline {subsection}{EM Lower Bound}{3}{section*.3}%
\contentsline {subsection}{EM Iterations}{4}{section*.4}%
\contentsline {subsection}{EM-Style Policy Iteration vs Policy Gradients}{4}{section*.5}%
\contentsline {paragraph}{EM-style policy iteration (distribution-space then projection).}{4}{section*.6}%
\contentsline {section}{\numberline {4}PPO}{4}{section.4}%
\contentsline {subsection}{Policy Gradient Foundation}{5}{section*.7}%
\contentsline {subsection}{Clipped Surrogate Objective}{5}{section*.8}%
\contentsline {subsection}{Value Function and Entropy}{5}{section*.9}%
\contentsline {subsection}{Full Objective}{5}{section*.10}%
\contentsline {subsection}{Generalised Advantage Estimation (GAE)}{5}{section*.11}%
\contentsline {subsection}{Sequence-Level PPO (LLM Case)}{6}{section*.12}%
\contentsline {section}{\numberline {5}V-MPO}{6}{section.5}%
\contentsline {subsection}{Implementation}{6}{section*.13}%
\contentsline {subsection}{Policy Evaluation (Critic Update)}{6}{section*.14}%
\contentsline {subsection}{Policy Improvement via EM}{6}{section*.15}%
\contentsline {subsection}{E-Step: Non-Parametric Policy Construction}{7}{section*.16}%
\contentsline {subsection}{M-Step: Parametric Projection with KL Constraint}{7}{section*.17}%
\contentsline {section}{\numberline {6}The Case for Dropout}{7}{section.6}%
\contentsline {subsection}{Why PPO Disables Dropout}{8}{section*.19}%
\contentsline {paragraph}{Problem 1: stochastic numerator.}{8}{section*.20}%
\contentsline {paragraph}{Problem 2: inconsistent denominator.}{8}{section*.21}%
\contentsline {paragraph}{Problem 3: KL penalty corruption.}{8}{section*.22}%
\contentsline {subsection}{Why V-MPO / EM-Style Methods Are Dropout-Compatible}{8}{section*.23}%
\contentsline {paragraph}{E-step: weights from advantages, not ratios.}{9}{section*.24}%
\contentsline {paragraph}{M-step: standard cross-entropy.}{9}{section*.25}%
\contentsline {paragraph}{No ratio, no conflict.}{9}{section*.26}%
\contentsline {subsection}{Practical Implications}{9}{section*.27}%
\contentsline {section}{\numberline {7}Direct Advantage Regression: Aligning LLMs with Online AI Reward}{9}{section.7}%
\contentsline {subsection}{RL Fine-tuning}{9}{section*.28}%
\contentsline {subsection}{Advantage Weighted Regression}{10}{section*.29}%
\contentsline {subsection}{Direct Advantage Regression}{10}{section*.30}%
\contentsline {subsubsection}{Dual-Constrained Objective}{10}{section*.31}%
\contentsline {paragraph}{Theorem.}{10}{section*.32}%
\contentsline {paragraph}{Proof.}{10}{section*.33}%
\contentsline {subsection}{Mapping \textsc {DAR} to V-MPO}{11}{section*.34}%
\contentsline {paragraph}{DAR closed-form target.}{11}{section*.35}%
\contentsline {paragraph}{V-MPO canonical target.}{11}{section*.36}%
\contentsline {paragraph}{Special case 1: identical reference and sampling policies.}{12}{section*.37}%
\contentsline {paragraph}{Special case 2: \(\alpha \rightarrow 0\) (reference KL vanishes).}{12}{section*.38}%
\contentsline {paragraph}{Algebraic equivalence (log-space explanation).}{12}{section*.39}%
\contentsline {paragraph}{Practical consequences and distinctions.}{12}{section*.40}%
\contentsline {paragraph}{Bridge to the EM.}{13}{section*.41}%
\contentsline {paragraph}{Sequence-level weighted loss (common form).}{13}{section*.42}%
\contentsline {section}{\numberline {8}Generalized EM Policy Improvement (GEMPI)}{13}{section.8}%
\contentsline {paragraph}{The GEMPI tuple.}{13}{section*.43}%
\contentsline {subsection}{General Regularized E-Step}{13}{section*.44}%
\contentsline {paragraph}{Theorem (Multi-KL Closed Form).}{13}{section*.45}%
\contentsline {paragraph}{Proof.}{13}{section*.46}%
\contentsline {paragraph}{Log-space form.}{14}{section*.47}%
\contentsline {paragraph}{Multi-temperature dual.}{14}{section*.48}%
\contentsline {subsection}{General M-Step}{14}{section*.49}%
\contentsline {paragraph}{Importance-weighted practical form.}{14}{section*.50}%
\contentsline {paragraph}{1. Partition function bias.}{15}{section*.51}%
\contentsline {paragraph}{2. Effective sample size and weight degeneracy.}{15}{section*.52}%
\contentsline {paragraph}{3. M-step gradient bias under finite ESS.}{15}{section*.53}%
\contentsline {paragraph}{Connection to GEMPI stabilisers.}{15}{section*.54}%
\contentsline {paragraph}{Remark on the population vs.\ sample limit.}{16}{section*.55}%
\contentsline {subsection}{Recovering Existing Methods}{16}{section*.56}%
\contentsline {paragraph}{V-MPO.}{16}{section*.57}%
\contentsline {paragraph}{DAR.}{16}{section*.58}%
\contentsline {paragraph}{AWR.}{16}{section*.59}%
\contentsline {paragraph}{SFT.}{16}{section*.60}%
\contentsline {paragraph}{DAR$\rightarrow $V-MPO as corollary.}{16}{section*.61}%
\contentsline {subsection}{The Role of Divergence Choice}{17}{section*.62}%
\contentsline {subsection}{Stability Properties as Structural Consequences}{17}{section*.63}%
\contentsline {paragraph}{Adaptive temperature.}{17}{section*.64}%
\contentsline {paragraph}{Trust regions in the M-step.}{17}{section*.65}%
\contentsline {paragraph}{Top-$k$ filtering.}{17}{section*.66}%
\contentsline {paragraph}{Dropout compatibility.}{17}{section*.67}%
\contentsline {subsection}{Novel Instantiations}{17}{section*.68}%
\contentsline {paragraph}{Adaptive-Temperature DAR (AT-DAR).}{18}{section*.69}%
\contentsline {paragraph}{DAR with M-step Trust Region (DAR-TR).}{18}{section*.70}%
\contentsline {paragraph}{Top-$k$ DAR.}{18}{section*.71}%
\contentsline {section}{\numberline {9}V-MPO for LLM RL within GEMPI}{18}{section.9}%
\contentsline {subsection}{GEMPI Instantiation for LLM V-MPO}{18}{section*.72}%
\contentsline {subsection}{Sequence-Level E-Step for Transformer Rollouts}{18}{section*.73}%
\contentsline {subsection}{M-Step as Weighted Teacher-Forced Transformer Training}{19}{section*.74}%
\contentsline {subsection}{Transformer-Specific Practicalities}{19}{section*.75}%
\contentsline {subsection}{Dropout in the LLM V-MPO M-Step}{19}{section*.76}%
\contentsline {section}{\numberline {10}Transformers - TrXL}{19}{section.10}%
\contentsline {subsection}{Implementation}{19}{section*.77}%
\contentsline {subsection}{GTrXL with V-MPO}{19}{section*.78}%
\contentsline {subsubsection}{Identity Map Reordering (TrXL-I)}{20}{section*.79}%
\contentsline {subsubsection}{Gating Layers}{20}{section*.80}%
\contentsline {subsubsection}{Why GTrXL Suits V-MPO}{20}{section*.81}%
\contentsline {subsubsection}{Architecture and Training Configuration}{20}{section*.82}%
\contentsline {section}{\numberline {11}References}{20}{section.11}%
